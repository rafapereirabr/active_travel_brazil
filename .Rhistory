##################### Set working directory -------------------------------------------------------
setwd("R:/Dropbox/github/active_travel_brazil")
##################### Load packages -------------------------------------------------------
source("./R-scripts/0 LoadPackages.R")
load('./data/pnad08.18y.design.rda')
load('./data/pns13.18y.design.rda')
svyby(~factor( dummyVehicle=="Yes") ,
~quintileBR, svymean ,
design = pns13.18y.design ,
vartype="ci", level = 0.95)
library(survey)
source("./R-scripts/0 LoadPackages.R")
load('./data/pns13.18y.design.rda')
svyby(~factor( dummyVehicle=="Yes") ,
~quintileBR, svymean ,
design = pns13.18y.design ,
vartype="ci", level = 0.95) %>% setDT()
svyby(~factor( dummyVehicle=="Yes") ,
~quintileBR, svymean ,
design = pns13.18y.design ,
vartype="ci", level = 0.95)
svyby(~factor( quintileBR) ,
~v4721 , svymean ,
design = pns13.18y.design ,
vartype="ci", level = 0.95)
svyby(~factor( quintileBR==1) ,
~v4721 , svymean ,
design = pns13.18y.design ,
vartype="ci", level = 0.95)
pns2013 <- readRDS("./data/pns2013.Rds")
pns2013[, .(m =mean(v4721)), by=quintileBR]
pns2013[, .(m =mean(v4721)), by=quintileBR]
setDT(pns2013)[, .(m =mean(v4721)), by=quintileBR]
library(data.table)
setDT(pns2013)[, .(m =mean(v4721)), by=quintileBR]
tab1 <- fread("./output_tables/tab1.csv")
tab1
setDT(pns2013)[, .(m =mean(v4721)), by=quintileBR]
options(digits=3)   # number of digits to show
options(scipen=999) # disable scientific notation
#####################  List of packages -------------------------------------------------------
# List of packages we are going to use
list.of.packages <-
c(
# download data
"downloader"
# Read data
, "readr"
, "foreign"
, "readxl"
, "SAScii"
# Manipulate data frames
, "data.table"
, "plyr"
, "dplyr"
, "fasttime"
, "pbapply"
, "tidyr"
, "reshape"
, "taRifx"
, "sqldf"
# Complex Sample Survey analysis
, "survey"
, "descr"
# stats functions
, "ineq"
, "stats"
# Make Plots
, "ggplot2"
, "grid"
, "gridExtra"
, "cowplot"
# Plots: Nice themes and colors
, "RColorBrewer"
, "scales"
, "ggthemes"
, "viridis"
, "gtable"
, "wesanderson"
# Miscellaneous
, "beepr"
, "bit64"
, "devtools"
, "stringi"
)
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)
library(utils)
library(devtools)
library(stringi)
new.packages <- !('microdadosBrasil' %in% installed.packages()[,"Package"])
if(length(new.packages)) devtools::install_github("lucasmation/microdadosBrasil")
library(microdadosBrasil)
lapply(list.of.packages, require, character.only = TRUE)
rm(list=ls())
gc(reset=T )
setwd("R:/Dropbox/github/active_travel_brazil") # test
source("./R-scripts/0 LoadPackages.R")
download_sourceData("PNS", 2013, unzip = T, root_path = "./data")
download_sourceData("PNS", 2013, unzip = T, root_path = "./data")
pns2013dom <- read_PNS("domicilios", i = 2013, root_path = ".")
pns2013dom <- read_PNS("domicilios", i = 2013, root_path = "./data")
